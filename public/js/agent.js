!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(module,exports){module.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){var r=n(5),i=n(7),a=i;a.v1=r,a.v4=i,e.exports=a},function(e,t,n){(function(t){var n,r=t.crypto||t.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var a=Array(16);n=function(){for(var e,t=0;16>t;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=255&e>>>((3&t)<<3);return a}}e.exports=n}).call(t,n(6))},function(e){for(var t=[],n=0;256>n;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var r=n||0,i=t;return i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+"-"+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]+i[e[r++]]}},function(e,t,n){e.exports=n(4)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n,r=[],i=!0,a=!1;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{!i&&s.return&&s.return()}finally{if(a)throw n}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=r(n(0)),s=r(n(8)),u=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t?window:this;this._acw=new s.default,this._acw.setMountpoint(n),window.addEventListener("message",this._handleMessage.bind(this),{once:!0}),this.id=o.default.v4(),this.handlingMessage=!1}return a(e,[{key:"_handleMessage",value:function(e){var t=e.data,n=e.source,r=e.origin;if(!this.handlingMessage){if(this.handlingMessage=!0,"Agent.Init"===t.name){var a=i(t.parameters,3),o=a[0],s=a[1],u=a[2];if(o.length)try{return this._acw.setManifest(o),this._acw.setDisplay(s),this._acw.setRemote(u),this._acw.setTransport(n,window,r),void this._acw.start()}catch(e){console.error(e)}}this.handlingMessage=!1,window.addEventListener("message",this._handleMessage.bind(this),{once:!0})}}}]),e}();t.default=u},function(e,t,n){var r=n(1),i=n(2),a=r(),o=[1|a[0],a[1],a[2],a[3],a[4],a[5]],s=16383&(a[6]<<8|a[7]),u=0,c=0;e.exports=function(e,t,n){var r=t&&n||0,a=t||[],l=void 0===(e=e||{}).clockseq?s:e.clockseq,f=void 0===e.msecs?(new Date).getTime():e.msecs,d=void 0===e.nsecs?c+1:e.nsecs,h=f-u+(d-c)/1e4;if(0>h&&void 0===e.clockseq&&(l=16383&l+1),(0>h||f>u)&&void 0===e.nsecs&&(d=0),1e4<=d)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=f,c=d,s=l;var v=(1e4*(268435455&(f+=122192928e5))+d)%4294967296;a[r++]=255&v>>>24,a[r++]=255&v>>>16,a[r++]=255&v>>>8,a[r++]=255&v;var p=268435455&f/4294967296*1e4;a[r++]=255&p>>>8,a[r++]=255&p,a[r++]=16|15&p>>>24,a[r++]=255&p>>>16,a[r++]=128|l>>>8,a[r++]=255&l;for(var y=e.node||o,g=0;6>g;++g)a[r+g]=y[g];return t||i(a)}},function(e){var t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,t,n){var r=n(1),i=n(2);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"==e?Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||r)();if(o[6]=64|15&o[6],o[8]=128|63&o[8],t)for(var s=0;16>s;++s)t[a+s]=o[s];return t||i(o)}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_uuid2=__webpack_require__(0),_uuid3=_interopRequireDefault(_uuid2),_Config=__webpack_require__(9),_Config2=_interopRequireDefault(_Config),_Message=__webpack_require__(10),_Message2=_interopRequireDefault(_Message),AgentClientWire=function(){function AgentClientWire(){_classCallCheck(this,AgentClientWire),this._requests=new Map,this._queue=new Set,this._ready=!1,this.sender=null,this.receiver=null,this.origin=null,this.defaultTimeout=15,this.handlers={},this.handlers.AgentClientWireOnReady=new Map}return _createClass(AgentClientWire,[{key:"setMountpoint",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.mountpoint=t,this.mountpoint.onReady=function(t){return e._ready?void t():void e.handlers.AgentClientWireOnReady.set(_uuid3.default.v4(),t)},this.mountpoint.onReadyAsync=function(){return new Promise(function(t){e.mountpoint.onReady(function(){return t()})})}}},{key:"setManifest",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.manifest=e}},{key:"setDisplay",value:function(e){this.displayId=e}},{key:"setRemote",value:function(e){this.remoteId=e}},{key:"setTransport",value:function(e,t,n){this.sender=e,this.receiver=t,this.origin=n}},{key:"start",value:function(){var e=this;this.receiver.addEventListener("message",this.message.bind(this)),this._queue.forEach(function(t){e.post(t),e._queue.delete(t)}),this.buildEndpoints(this.manifest,this.mountpoint),Array.from(this.handlers.AgentClientWireOnReady.values()).forEach(function(e){return e()}),this._ready=!0}},{key:"message",value:function(e){var t=e.data,n=t.type,r=t.event,i=t.destination,a=t.error,o=t.data;if(("response"===n||"response"===r)&&this._requests.has(i)){var s=this._requests.get(i),u=s.resolve,c=s.reject;if(a)return c(a);u.apply(void 0,_toConsumableArray(o))}"event"===r&&this.handlers[i]&&this.handlers[i].forEach(function(e){return e.apply(void 0,_toConsumableArray(o))})}},{key:"post",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.message,n=t.message,r=t.transferList;if(window["AgentM.RPC"]){var i=JSON.stringify(n);window["AgentM.RPC"].fromClient(i)}if(!this.sender&&!window["AgentM.RPC"])return this._queue.add(e);if(this.sender)try{this.sender.postMessage(n,this.origin,r)}catch(e){console.error(e)}}},{key:"checkArguments",value:function(e){return e.every(function(e){try{switch(!0){case e instanceof ArrayBuffer:return!0;default:JSON.stringify(e)}return!0}catch(e){return!1}})}},{key:"timeout",value:function(e){return new Promise(function(t,n){setTimeout(function(){return n(new Error("Request timed out"))},e)})}},{key:"emit",value:function(e,t,n){var r=this;return new Promise(function(i,a){try{r.checkArguments(n)||a(new Error("Untransferrable argument provided")),r._requests.set(e,{resolve:i,reject:a});var o=new _Message2.default(e,t,n,r.displayId);r.post(o)}catch(e){return a(e)}})}},{key:"notify",value:function(e,t,n){var r=_uuid3.default.v4(),i=t.find(function(e){return e instanceof _Config2.default}),a=n;return i&&(a=i.timeout),Promise.race([this.emit(r,e,t),this.timeout(1e3*a)])}},{key:"getEvaldArgument",value:function(code,ctx){switch(!0){case"this"===ctx:var thisself=this;return thisself.__eval=function(){var val=eval(code);return val},thisself.__eval();case"window"===ctx:return window.eval(code);default:var self=window[ctx];return self.__eval=function(){return eval(code)},self.__eval()}}},{key:"buildEndpoints",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t.forEach(function(t){var r=t.namespace,i=t.properties,a=e.buildGenerateFromNamespace(n,r);i.forEach(function(t){var n=t.uuid,r=t.namespace,i=t.type,o=t.name,s=t.target,u=t.evaldParams,c=t.timeout;c=c||e.defaultTimeout;var l=e.buildGenerateFromNamespace(a,r);switch(!0){case"StandardMethod"===i:l[o]=function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=r;if(u){var o=u.arg,s=u.code,l=u.ctx;if(a.length>=o&&(a[o-1]=e.getEvaldArgument(s,l)),a.length<o){var f=o-a.length,d=Array.from({length:f});(a=[].concat(_toConsumableArray(a),_toConsumableArray(d)))[o-1]=e.getEvaldArgument(s,l)}}return e.notify(n,a,c)};break;case"StandardProperty"===i:l[o]=s;break;case"EvaldMethod"===i:window.eval(s);break;case"EventListener"===i:e.handlers[o]=new Map,l[o]=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=_uuid3.default.v4();return e.handlers[o].set(r,function(){return n.once&&e.handlers[o].delete(r),t.apply(void 0,arguments)}),function(){e.handlers[o].delete(r)}}}})})}},{key:"buildGenerateFromNamespace",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"/").replace("/Agent","");if("/"===t)return e;var n=t.split("/").reverse().filter(function(e){return e});return function e(t){var r=n.pop();return r&&(t[r]=t[r]||{}),t[r]&&0<n.length?e(t[r]):t[r]}(e)}}]),AgentClientWire}();exports.default=AgentClientWire},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),Object.assign(this,t)}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),r=function(){function e(t,n,r,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.source=t,this.destination=n,this.arguments=r,this.displayId=i}return n(e,[{key:"setSource",value:function(e){this.source=e}},{key:"setDestination",value:function(e){this.destination=e}},{key:"setArguments",value:function(e){this.arguments=e}},{key:"setDisplay",value:function(e){this.displayId=e}},{key:"message",get:function(){return{message:{source:this.source,destination:this.destination,arguments:this.arguments,displayId:this.displayId}}}}]),e}();t.default=r}])},function(e,t,n){"use strict";var r,i=n(0),a=(r=i)&&r.__esModule?r:{default:r};window.Agent=new a.default}]);